import{_ as d}from"./ValaxyMain.vue_vue_type_style_index_0_lang-DRMwKLA6.js";import{a as c,p,o,c as E,w as l,f as g,r as a,g as s,h as i}from"./app-B_lbTwZU.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-DXX2ZxjQ.js";import"./YunCard.vue_vue_type_script_setup_true_lang-DDKa6XCF.js";import"./index-C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-l3Vxf24V.js";import"./post-B4jxDa69.js";const u=s("h1",{id:"leetcode-数据库刷题笔记",tabindex:"-1"},[i("LeetCode 数据库刷题笔记 "),s("a",{class:"header-anchor",href:"#leetcode-数据库刷题笔记","aria-label":'Permalink to "LeetCode 数据库刷题笔记"'},"​")],-1),y=s("blockquote",null,[s("p",null,"只做重点的记录。")],-1),F=s("h2",{id:"_550-游戏玩法分析-iv-中等",tabindex:"-1"},[s("a",{href:"https://leetcode.cn/problems/game-play-analysis-iv/",target:"_blank",rel:"noreferrer"},"550. 游戏玩法分析 IV"),i(" 中等 "),s("a",{class:"header-anchor",href:"#_550-游戏玩法分析-iv-中等","aria-label":'Permalink to "[550. 游戏玩法分析 IV](https://leetcode.cn/problems/game-play-analysis-iv/) 中等"'},"​")],-1),m=s("hr",null,null,-1),C=s("p",null,[i("Table: "),s("code",null,"Activity")],-1),_=s("div",{class:"language- vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"+--------------+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| Column Name  | Type    |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+--------------+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| player_id    | int     |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| device_id    | int     |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| event_date   | date    |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| games_played | int     |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+--------------+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"（player_id，event_date）是此表的主键（具有唯一值的列的组合）。")]),i(`
`),s("span",{class:"line"},[s("span",null,"这张表显示了某些游戏的玩家的活动情况。")]),i(`
`),s("span",{class:"line"},[s("span",null,"每一行是一个玩家的记录，他在某一天使用某个设备注销之前登录并玩了很多游戏（可能是 0）。")])])]),s("button",{class:"collapse"})],-1),v=s("p",null,[i("编写解决方案，报告在首次登录的第二天再次登录的玩家的 "),s("strong",null,"比率"),i("，"),s("strong",null,"四舍五入到小数点后两位"),i("。换句话说，你需要计算从首次登录日期开始至少连续两天登录的玩家的数量，然后除以玩家总数。")],-1),b=s("p",null,"结果格式如下所示：",-1),D=s("p",null,[s("strong",null,"示例 1：")],-1),A=s("div",{class:"language- vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"输入：")]),i(`
`),s("span",{class:"line"},[s("span",null,"Activity table:")]),i(`
`),s("span",{class:"line"},[s("span",null,"+-----------+-----------+------------+--------------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| player_id | device_id | event_date | games_played |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+-----------+-----------+------------+--------------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 1         | 2         | 2016-03-01 | 5            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 1         | 2         | 2016-03-02 | 6            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 2         | 3         | 2017-06-25 | 1            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 3         | 1         | 2016-03-02 | 0            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 3         | 4         | 2018-07-03 | 5            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+-----------+-----------+------------+--------------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"输出：")]),i(`
`),s("span",{class:"line"},[s("span",null,"+-----------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| fraction  |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+-----------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 0.33      |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+-----------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"解释：")]),i(`
`),s("span",{class:"line"},[s("span",null,"只有 ID 为 1 的玩家在第一天登录后才重新登录，所以答案是 1/3 = 0.33")])])]),s("button",{class:"collapse"})],-1),B=s("h3",{id:"答案",tabindex:"-1"},[i("答案 "),s("a",{class:"header-anchor",href:"#答案","aria-label":'Permalink to "答案"'},"​")],-1),f=s("div",{class:"language-sql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"sql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"SELECT"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    ROUND"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"login_next_day"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"count_login_next_day"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," /"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," COUNT"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DISTINCT"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," activity"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"player_id"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"), "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"AS"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," fraction ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FROM"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Activity activity, ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    (")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        SELECT"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            COUNT"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"AS"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," count_login_next_day ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        FROM"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            (")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                SELECT"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"                    a"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"player_id"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"                    MIN"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"a"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"event_date"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"AS"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," first_login ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                FROM"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    Activity a ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                GROUP BY"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"                    a"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"player_id"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                ORDER BY"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"                    a"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"event_date")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            ) first_logins, ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            Activity aa ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        WHERE"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            aa"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"event_date"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," DATE_ADD("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"first_logins"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"first_login"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", INTERVAL "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," DAY"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            AND"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," first_logins"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"player_id"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," aa"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"player_id")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    ) login_next_day;")])])]),s("button",{class:"collapse"})],-1),S=s("h2",{id:"_570-至少有5名直接下属的经理-中等",tabindex:"-1"},[s("a",{href:"https://leetcode.cn/problems/managers-with-at-least-5-direct-reports/",target:"_blank",rel:"noreferrer"},"570. 至少有5名直接下属的经理"),i(" 中等 "),s("a",{class:"header-anchor",href:"#_570-至少有5名直接下属的经理-中等","aria-label":'Permalink to "[570. 至少有5名直接下属的经理](https://leetcode.cn/problems/managers-with-at-least-5-direct-reports/) 中等"'},"​")],-1),I=s("p",null,[i("表: "),s("code",null,"Employee")],-1),T=s("div",{class:"language- vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"+-------------+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| Column Name | Type    |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+-------------+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| id          | int     |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| name        | varchar |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| department  | varchar |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| managerId   | int     |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+-------------+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"id 是此表的主键（具有唯一值的列）。")]),i(`
`),s("span",{class:"line"},[s("span",null,"该表的每一行表示雇员的名字、他们的部门和他们的经理的id。")]),i(`
`),s("span",{class:"line"},[s("span",null,"如果managerId为空，则该员工没有经理。")]),i(`
`),s("span",{class:"line"},[s("span",null,"没有员工会成为自己的管理者。")])])]),s("button",{class:"collapse"})],-1),q=s("p",null,[i("编写一个解决方案，找出至少有"),s("strong",null,"五个直接下属"),i("的经理。")],-1),L=s("p",null,[i("以 "),s("strong",null,"任意顺序"),i(" 返回结果表。")],-1),N=s("p",null,"查询结果格式如下所示。",-1),R=s("p",null,[s("strong",null,"示例 1:")],-1),x=s("div",{class:"language- vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"输入: ")]),i(`
`),s("span",{class:"line"},[s("span",null,"Employee 表:")]),i(`
`),s("span",{class:"line"},[s("span",null,"+-----+-------+------------+-----------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| id  | name  | department | managerId |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+-----+-------+------------+-----------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 101 | John  | A          | Null      |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 102 | Dan   | A          | 101       |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 103 | James | A          | 101       |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 104 | Amy   | A          | 101       |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 105 | Anne  | A          | 101       |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 106 | Ron   | B          | 101       |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+-----+-------+------------+-----------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"输出: ")]),i(`
`),s("span",{class:"line"},[s("span",null,"+------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| name |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| John |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+------+")])])]),s("button",{class:"collapse"})],-1),O=s("h3",{id:"答案-1",tabindex:"-1"},[i("答案 "),s("a",{class:"header-anchor",href:"#答案-1","aria-label":'Permalink to "答案"'},"​")],-1),M=s("div",{class:"language-sql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"sql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"# Write your MySQL query "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"statement"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," below")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"select"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," e"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"name"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," from"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Employee e")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"where"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," e"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"id"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," in"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    select"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," ee"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"id"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," from"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Employee ee, Employee eee")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    where"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," eee"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"managerId"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," ee"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"id"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," #("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    group by"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," ee"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"id"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    having"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," count"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"distinct"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," eee"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"id"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 5"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," #("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")])])]),s("button",{class:"collapse"})],-1),P=s("p",null,[i("需要注意的是，要查找对于每一个分组的条件，写在"),s("code",null,"(1)"),i("处，对筛选之后分组的结果再进行数量限制，写在"),s("code",null,"(2)"),i("处。与之类似的还有"),s("strong",null,"题目 185"),i("，也可以使用子查询做。")],-1),w=s("h2",{id:"_185-部门工资前三高的所有员工-困难",tabindex:"-1"},[s("a",{href:"https://leetcode.cn/problems/department-top-three-salaries/",target:"_blank",rel:"noreferrer"},"185. 部门工资前三高的所有员工"),i(" 困难 "),s("a",{class:"header-anchor",href:"#_185-部门工资前三高的所有员工-困难","aria-label":'Permalink to "[185. 部门工资前三高的所有员工](https://leetcode.cn/problems/department-top-three-salaries/) 困难"'},"​")],-1),$=s("p",null,[i("表: "),s("code",null,"Employee")],-1),J=s("div",{class:"language- vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"+--------------+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| Column Name  | Type    |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+--------------+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| id           | int     |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| name         | varchar |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| salary       | int     |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| departmentId | int     |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+--------------+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"id 是该表的主键列(具有唯一值的列)。")]),i(`
`),s("span",{class:"line"},[s("span",null,"departmentId 是 Department 表中 ID 的外键（reference 列）。")]),i(`
`),s("span",{class:"line"},[s("span",null,"该表的每一行都表示员工的ID、姓名和工资。它还包含了他们部门的ID。")])])]),s("button",{class:"collapse"})],-1),H=s("p",null,[i("表: "),s("code",null,"Department")],-1),V=s("div",{class:"language- vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"+-------------+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| Column Name | Type    |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+-------------+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| id          | int     |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| name        | varchar |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+-------------+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"id 是该表的主键列(具有唯一值的列)。")]),i(`
`),s("span",{class:"line"},[s("span",null,"该表的每一行表示部门ID和部门名。")])])]),s("button",{class:"collapse"})],-1),U=s("p",null,[i("公司的主管们感兴趣的是公司每个部门中谁赚的钱最多。一个部门的 "),s("strong",null,"高收入者"),i(" 是指一个员工的工资在该部门的 "),s("strong",null,"不同"),i(" 工资中 "),s("strong",null,"排名前三"),i(" 。")],-1),G=s("p",null,[i("编写解决方案，找出每个部门中 "),s("strong",null,"收入高的员工"),i(" 。")],-1),Q=s("p",null,[i("以 "),s("strong",null,"任意顺序"),i(" 返回结果表。")],-1),W=s("p",null,"返回结果格式如下所示。",-1),Y=s("p",null,[s("strong",null,"示例 1:")],-1),j=s("div",{class:"language- vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"输入: ")]),i(`
`),s("span",{class:"line"},[s("span",null,"Employee 表:")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+-------+--------+--------------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| id | name  | salary | departmentId |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+-------+--------+--------------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 1  | Joe   | 85000  | 1            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 2  | Henry | 80000  | 2            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 3  | Sam   | 60000  | 2            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 4  | Max   | 90000  | 1            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 5  | Janet | 69000  | 1            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 6  | Randy | 85000  | 1            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 7  | Will  | 70000  | 1            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+-------+--------+--------------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"Department  表:")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+-------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| id | name  |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+-------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 1  | IT    |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 2  | Sales |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+-------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"输出: ")]),i(`
`),s("span",{class:"line"},[s("span",null,"+------------+----------+--------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| Department | Employee | Salary |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+------------+----------+--------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| IT         | Max      | 90000  |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| IT         | Joe      | 85000  |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| IT         | Randy    | 85000  |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| IT         | Will     | 70000  |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| Sales      | Henry    | 80000  |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| Sales      | Sam      | 60000  |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+------------+----------+--------+")])])]),s("button",{class:"collapse"})],-1),Z=s("h3",{id:"答案-2",tabindex:"-1"},[i("答案 "),s("a",{class:"header-anchor",href:"#答案-2","aria-label":'Permalink to "答案"'},"​")],-1),z=s("div",{class:"language-sql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"sql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"SELECT")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"	d"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"NAME"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," AS"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Department,")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"	e"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"NAME"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," AS"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Employee,")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"	e"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"salary"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," AS"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Salary ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"FROM")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"	employee e")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"	LEFT JOIN"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," department d "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ON"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," e"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"departmentId"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," d"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"id"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"WHERE")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"	e"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"id"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," IN"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"	SELECT")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"		e1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"id"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"	FROM")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"		employee e1,")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"		employee e2 ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"	WHERE")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"		e1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"salary"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," <="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," e2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"salary"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"		AND"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," e1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"departmentId"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," e2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"departmentId"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"	GROUP BY")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"		e1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"id"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"	HAVING")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"		count"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"( "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DISTINCT"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," e2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"salary"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ) "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 3"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"	) ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ORDER BY")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"	Department,")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"	Salary "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"DESC")])])]),s("button",{class:"collapse"})],-1),K=s("div",{class:"language-sql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"sql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"select"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Department, Employee, Salary")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"from"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    select"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," d"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Name"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," as"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Department, "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"e"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Name"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," as"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Employee, "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"e"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Salary"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," as"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Salary, ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"	dense_rank"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"over"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"partition"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," by"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," DepartmentId "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"order by"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Salary "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"desc"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," rk")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    from"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Employee "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," e, Department "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"as"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," d")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    where"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," e"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"DepartmentId"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," d"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Id")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") m")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"where"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," rk "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 3"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")])])]),s("button",{class:"collapse"})],-1),X=s("h2",{id:"_181-超过经理收入的员工",tabindex:"-1"},[i("181. 超过经理收入的员工 "),s("a",{class:"header-anchor",href:"#_181-超过经理收入的员工","aria-label":'Permalink to "181. 超过经理收入的员工"'},"​")],-1),ss=s("h2",{id:"_183-部门工资最高的员工",tabindex:"-1"},[i("183. 部门工资最高的员工 "),s("a",{class:"header-anchor",href:"#_183-部门工资最高的员工","aria-label":'Permalink to "183. 部门工资最高的员工"'},"​")],-1),is=s("div",{class:"language-mysql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"mysql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"输入：")]),i(`
`),s("span",{class:"line"},[s("span",null,"Employee 表:")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+-------+--------+--------------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| id | name  | salary | departmentId |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+-------+--------+--------------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 1  | Joe   | 70000  | 1            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 2  | Jim   | 90000  | 1            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 3  | Henry | 80000  | 2            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 4  | Sam   | 60000  | 2            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 5  | Max   | 90000  | 1            |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+-------+--------+--------------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"Department 表:")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+-------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| id | name  |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+-------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 1  | IT    |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 2  | Sales |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+-------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"输出：")]),i(`
`),s("span",{class:"line"},[s("span",null,"+------------+----------+--------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| Department | Employee | Salary |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+------------+----------+--------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| IT         | Jim      | 90000  |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| Sales      | Henry    | 80000  |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| IT         | Max      | 90000  |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+------------+----------+--------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"解释：Max 和 Jim 在 IT 部门的工资都是最高的，Henry 在销售部的工资最高。")])])]),s("button",{class:"collapse"})],-1),ls=s("p",null,[i("双字段使用"),s("code",null,"in")],-1),ns=s("div",{class:"language- vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"select d.name as Department, e.name as Employee, e.Salary as Salary")]),i(`
`),s("span",{class:"line"},[s("span",null,"from Employee e , Department d")]),i(`
`),s("span",{class:"line"},[s("span",null,"where e.Departmentid = d.id")]),i(`
`),s("span",{class:"line"},[s("span",null,"and")]),i(`
`),s("span",{class:"line"},[s("span",null,"(e.DepartmentId, Salary)")]),i(`
`),s("span",{class:"line"},[s("span",null,"in")]),i(`
`),s("span",{class:"line"},[s("span",null,"(select Departmentid, max(Salary) from Employee GROUP BY DepartmentId )")])])]),s("button",{class:"collapse"})],-1),as=s("h2",{id:"_180-连续出现的数字",tabindex:"-1"},[i("180. 连续出现的数字 "),s("a",{class:"header-anchor",href:"#_180-连续出现的数字","aria-label":'Permalink to "180. 连续出现的数字"'},"​")],-1),es=s("div",{class:"language-mysql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"mysql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"输入：")]),i(`
`),s("span",{class:"line"},[s("span",null,"Logs 表：")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+-----+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| Id | Num |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+-----+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 1  | 1   |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 2  | 1   |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 3  | 1   |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 4  | 2   |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 5  | 1   |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 6  | 2   |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 7  | 2   |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+-----+")]),i(`
`),s("span",{class:"line"},[s("span",null,"输出：")]),i(`
`),s("span",{class:"line"},[s("span",null,"Result 表：")]),i(`
`),s("span",{class:"line"},[s("span",null,"+-----------------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| ConsecutiveNums |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+-----------------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 1               |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+-----------------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"解释：1 是唯一连续出现至少三次的数字。")])])]),s("button",{class:"collapse"})],-1),ts=s("p",null,"对一张表重复关联3次，横向比较。",-1),hs=s("div",{class:"language-mysql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"mysql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"select distinct l1.num as ConsecutiveNums")]),i(`
`),s("span",{class:"line"},[s("span",null,"from logs l1, logs l2, logs l3")]),i(`
`),s("span",{class:"line"},[s("span",null,"where l1.num = l2.num and l2.num = l3.num and l1.id = l2.id - 1 and l2.id = l3.id - 1")])])]),s("button",{class:"collapse"})],-1),ps=s("h2",{id:"_178-分数排名",tabindex:"-1"},[i("178. 分数排名 "),s("a",{class:"header-anchor",href:"#_178-分数排名","aria-label":'Permalink to "178. 分数排名"'},"​")],-1),ks=s("p",null,[i("MySql8.x 版本以上支持"),s("code",null,"rank()"),i("开窗函数。")],-1),rs=s("p",null,"Oracle 和 SqlServer 也支持，但是没有查具体版本。",-1),ds=s("blockquote",null,[s("p",null,[s("a",{href:"https://blog.csdn.net/u013317445/article/details/100514974",target:"_blank",rel:"noreferrer"},"https://blog.csdn.net/u013317445/article/details/100514974")]),s("p",null,"MySql 之 rank() over(order by)、rank() over(partition by order by)")],-1),cs=s("p",null,"在版本不支持开窗函数的情况下，使用语义分析，**rank **即为前面有多少比自己「大」的数据，根据排名规则（如并列排名，顺序排名等）进行去重等操作，一样可以实现添加排名的功能。",-1),os=s("div",{class:"language-mysql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"mysql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"select a.Score as Score,")]),i(`
`),s("span",{class:"line"},[s("span",null,"(select count(distinct b.Score) from Scores b where b.Score >= a.Score) as Rank")]),i(`
`),s("span",{class:"line"},[s("span",null,"from Scores a")]),i(`
`),s("span",{class:"line"},[s("span",null,"order by a.Score DESC")])])]),s("button",{class:"collapse"})],-1),Es=s("h2",{id:"_626-换座位",tabindex:"-1"},[i("626. 换座位 "),s("a",{class:"header-anchor",href:"#_626-换座位","aria-label":'Permalink to "626. 换座位"'},"​")],-1),gs=s("div",{class:"language-mysql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"mysql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"输入:")]),i(`
`),s("span",{class:"line"},[s("span",null,"Seat 表:")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| id | student |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 1  | Abbot   |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 2  | Doris   |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 3  | Emerson |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 4  | Green   |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 5  | Jeames  |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"输出:")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| id | student |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 1  | Doris   |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 2  | Abbot   |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 3  | Green   |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 4  | Emerson |")]),i(`
`),s("span",{class:"line"},[s("span",null,"| 5  | Jeames  |")]),i(`
`),s("span",{class:"line"},[s("span",null,"+----+---------+")]),i(`
`),s("span",{class:"line"},[s("span",null,"解释:")]),i(`
`),s("span",{class:"line"},[s("span",null,"请注意，如果学生人数为奇数，则不需要更换最后一名学生的座位。")])])]),s("button",{class:"collapse"})],-1),us=s("p",null,"解法一：",-1),ys=s("div",{class:"language-mysql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"mysql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"select (")]),i(`
`),s("span",{class:"line"},[s("span",null,"    case")]),i(`
`),s("span",{class:"line"},[s("span",null,"        when mod(id, 2) = 1 and id != counts.counts then id + 1")]),i(`
`),s("span",{class:"line"},[s("span",null,"        when mod(id, 2) = 1 and id = counts.counts then id")]),i(`
`),s("span",{class:"line"},[s("span",null,"        else id - 1")]),i(`
`),s("span",{class:"line"},[s("span",null,"        end) as id, student")]),i(`
`),s("span",{class:"line"},[s("span",null,"from seat,")]),i(`
`),s("span",{class:"line"},[s("span",null,"    (select count(1) as counts")]),i(`
`),s("span",{class:"line"},[s("span",null,"    from seat) counts")]),i(`
`),s("span",{class:"line"},[s("span",null,"order by id asc")])])]),s("button",{class:"collapse"})],-1),Fs=s("p",null,"解法二：",-1),ms=s("div",{class:"language-mysql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"mysql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"select s1.id, coalesce(s2.student, s1.student) as student")]),i(`
`),s("span",{class:"line"},[s("span",null,"from seat s1")]),i(`
`),s("span",{class:"line"},[s("span",null,"left join seat s2")]),i(`
`),s("span",{class:"line"},[s("span",null,"on (s1.id+1)^1-1 = s2.id")])])]),s("button",{class:"collapse"})],-1),Cs=s("p",null,"位运算实现相邻两数互换位置。",-1),qs={__name:"LeetCode-SQL-notes",setup(_s,{expose:k}){const e=JSON.parse('{"title":"LeetCode 数据库刷题笔记","description":"","frontmatter":{"title":"LeetCode 数据库刷题笔记","author":"苏","date":"2022-11-02T18:04:34.000Z","tags":["LeetCode","数据库"],"categories":["LeetCode","数据库"],"readmore":true,"excerpt":"记录在 LeetCode SQL 相关的题目。调皮的小知识点有点多，用笔记📔把它们一网打尽！"},"headers":[{"level":2,"title":"550. 游戏玩法分析 IV 中等","slug":"_550-游戏玩法分析-iv-中等","link":"#_550-游戏玩法分析-iv-中等","children":[{"level":3,"title":"答案","slug":"答案","link":"#答案","children":[]}]},{"level":2,"title":"570. 至少有5名直接下属的经理 中等","slug":"_570-至少有5名直接下属的经理-中等","link":"#_570-至少有5名直接下属的经理-中等","children":[{"level":3,"title":"答案","slug":"答案-1","link":"#答案-1","children":[]}]},{"level":2,"title":"185. 部门工资前三高的所有员工 困难","slug":"_185-部门工资前三高的所有员工-困难","link":"#_185-部门工资前三高的所有员工-困难","children":[{"level":3,"title":"答案","slug":"答案-2","link":"#答案-2","children":[]}]},{"level":2,"title":"181. 超过经理收入的员工","slug":"_181-超过经理收入的员工","link":"#_181-超过经理收入的员工","children":[]},{"level":2,"title":"183. 部门工资最高的员工","slug":"_183-部门工资最高的员工","link":"#_183-部门工资最高的员工","children":[]},{"level":2,"title":"180. 连续出现的数字","slug":"_180-连续出现的数字","link":"#_180-连续出现的数字","children":[]},{"level":2,"title":"178. 分数排名","slug":"_178-分数排名","link":"#_178-分数排名","children":[]},{"level":2,"title":"626. 换座位","slug":"_626-换座位","link":"#_626-换座位","children":[]}],"relativePath":"pages/posts/LeetCode-SQL-notes.md","path":"/home/runner/work/674019130.github.io/674019130.github.io/pages/posts/LeetCode-SQL-notes.md","lastUpdated":1719766846000}'),h=c(),t=e.frontmatter||{};return h.meta.frontmatter=Object.assign(h.meta.frontmatter||{},e.frontmatter||{}),p("pageData",e),p("valaxy:frontmatter",t),globalThis.$frontmatter=t,k({frontmatter:{title:"LeetCode 数据库刷题笔记",author:"苏",date:"2022-11-02T18:04:34.000Z",tags:["LeetCode","数据库"],categories:["LeetCode","数据库"],readmore:!0,excerpt:"记录在 LeetCode SQL 相关的题目。调皮的小知识点有点多，用笔记📔把它们一网打尽！"}}),(n,bs)=>{const r=d;return o(),E(r,{frontmatter:g(t)},{"main-content-md":l(()=>[u,y,F,m,C,_,v,b,D,A,B,f,S,I,T,q,L,N,R,x,O,M,P,w,$,J,H,V,U,G,Q,W,Y,j,Z,z,K,X,ss,is,ls,ns,as,es,ts,hs,ps,ks,rs,ds,cs,os,Es,gs,us,ys,Fs,ms,Cs]),"main-header":l(()=>[a(n.$slots,"main-header")]),"main-header-after":l(()=>[a(n.$slots,"main-header-after")]),"main-nav":l(()=>[a(n.$slots,"main-nav")]),"main-content":l(()=>[a(n.$slots,"main-content")]),"main-content-after":l(()=>[a(n.$slots,"main-content-after")]),"main-nav-before":l(()=>[a(n.$slots,"main-nav-before")]),"main-nav-after":l(()=>[a(n.$slots,"main-nav-after")]),comment:l(()=>[a(n.$slots,"comment")]),footer:l(()=>[a(n.$slots,"footer")]),aside:l(()=>[a(n.$slots,"aside")]),"aside-custom":l(()=>[a(n.$slots,"aside-custom")]),default:l(()=>[a(n.$slots,"default")]),_:3},8,["frontmatter"])}}};export{qs as default};
